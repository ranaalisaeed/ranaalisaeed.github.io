<head>
  <link href="https://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1"
  />

  <title>
    {% if page.title == "Home" %} {{ site.title }} &middot; {{ site.tagline }}
    {% else %} {{ page.title }} &middot; {{ site.title }} {% endif %}
  </title>

  {% if page.url and site.baseurl %}
  <link rel="canonical" href="{{ page.url | absolute_url }}" />
  {% endif %} {% include tailwind-minimal.html %}

  <link rel="stylesheet" href="{{ '/public/css/poole.css' | absolute_url }}" />
  <link rel="stylesheet" href="{{ '/public/css/syntax.css' | absolute_url }}" />
  <link rel="stylesheet" href="{{ '/public/css/lanyon.css' | absolute_url }}" />
  <link rel="stylesheet" href="{{ '/public/css/custom.css' | absolute_url }}" />
  <link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400"
  />

  <link
    rel="apple-touch-icon-precomposed"
    sizes="144x144"
    href="{{ '/public/apple-touch-icon-precomposed.png' | absolute_url }}"
  />
  <link rel="shortcut icon" href="{{ '/public/favicon.png' | absolute_url }}" />

  <link
    rel="alternate"
    type="application/rss+xml"
    title="RSS"
    href="{{ '/atom.xml' | absolute_url }}"
  />

  {% include structured-data.html %}

  <!-- Web Vitals monitoring - simplified approach -->
  <script>
    // Only load Web Vitals in non-production
    if (
      window.location.hostname === "localhost" ||
      window.location.hostname === "127.0.0.1"
    ) {
      // Manually load the script
      const webVitalsScript = document.createElement("script");
      webVitalsScript.src =
        "https://unpkg.com/web-vitals@3/dist/web-vitals.iife.js";
      webVitalsScript.async = true;
      webVitalsScript.onload = function () {
        // When script loads, access the global webVitals object
        if (typeof webVitals !== "undefined") {
          webVitals.onCLS(sendToAnalytics);
          webVitals.onFID(sendToAnalytics);
          webVitals.onLCP(sendToAnalytics);
          webVitals.onFCP(sendToAnalytics);
          webVitals.onTTFB(sendToAnalytics);
        }
      };
      document.head.appendChild(webVitalsScript);
    }

    function sendToAnalytics(metric) {
      // Log to console during development
      console.log(metric);

      // Send to Google Analytics if available
      if (window.gtag) {
        gtag("event", "web_vitals", {
          event_category: "Web Vitals",
          event_label: metric.name,
          value: Math.round(metric.value),
          non_interaction: true,
          metric_rating: metric.rating,
          metric_id: metric.id,
          metric_delta: metric.delta,
        });
      }
    }
  </script>
</head>