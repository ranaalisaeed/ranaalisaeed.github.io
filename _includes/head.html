<head>
  <link href="https://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1"
  />

  <title>
    {% if page.title == "Home" %} {{ site.title }} &middot; {{ site.tagline }}
    {% else %} {{ page.title }} &middot; {{ site.title }} {% endif %}
  </title>

  {% if page.url and site.baseurl %}
  <link rel="canonical" href="{{ page.url | absolute_url }}" />
  {% endif %}

  <link rel="stylesheet" href="{{ '/public/css/poole.css' | absolute_url }}" />
  <link rel="stylesheet" href="{{ '/public/css/syntax.css' | absolute_url }}" />
  <link rel="stylesheet" href="{{ '/public/css/lanyon.css' | absolute_url }}" />
  <link rel="stylesheet" href="{{ '/public/css/my.css' | absolute_url }}" />
  <link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400"
  />

  <link
    rel="apple-touch-icon-precomposed"
    sizes="144x144"
    href="{{ '/public/apple-touch-icon-precomposed.png' | absolute_url }}"
  />
  <link rel="shortcut icon" href="{{ '/public/favicon.png' | absolute_url }}" />

  <link
    rel="alternate"
    type="application/rss+xml"
    title="RSS"
    href="{{ '/atom.xml' | absolute_url }}"
  />

  {% if site.google_analytics_id %}
  <script
    async
    src="https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics_id }}"
  ></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());
    gtag("config", "{{ site.google_analytics_id }}");
  </script>
  {% endif %} {% include structured-data.html %}

  <script
    async
    src="https://unpkg.com/web-vitals/dist/web-vitals.iife.js"
  ></script>

  <!-- Web Vitals monitoring -->
  <script type="module">
    import {
      onCLS,
      onFID,
      onLCP,
      onFCP,
      onTTFB,
    } from "https://unpkg.com/web-vitals@3/dist/web-vitals.attribution.js";

    function sendToAnalytics(metric) {
      // Log to console during development
      console.log(metric);

      // Send to Google Analytics if available
      if (window.gtag) {
        gtag("event", "web_vitals", {
          event_category: "Web Vitals",
          event_label: metric.name,
          value: Math.round(metric.value),
          non_interaction: true,
          // Include additional dimension data available via attribution
          metric_rating: metric.rating,
          metric_id: metric.id,
          metric_delta: metric.delta,
        });
      }
    }

    // When the script loads, start measuring
    onCLS(sendToAnalytics);
    onFID(sendToAnalytics);
    onLCP(sendToAnalytics);
    onFCP(sendToAnalytics);
    onTTFB(sendToAnalytics);
  </script>
</head>